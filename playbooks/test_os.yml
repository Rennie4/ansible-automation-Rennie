
---
- name: Test connectivity and show OS details
  hosts: all
  gather_facts: true

  tasks:
    - name: Ping Linux/Unix/macOS hosts
      ansible.builtin.ping:
      when: ansible_facts['os_family'] != 'Windows'

    - name: Ping Windows hosts
      ansible.windows.win_ping:
      when: ansible_facts['os_family'] == 'Windows'

    - name: Display success message (Linux/Unix/macOS)
      ansible.builtin.debug:
        msg: >-
          SUCCESS: Connected to {{ inventory_hostname }}.
          OS family={{ ansible_facts['os_family'] }},
          distribution={{ ansible_facts['distribution'] | default('N/A') }},
          version={{ ansible_facts['distribution_version'] | default('N/A') }}.
      when: ansible_facts['os_family'] != 'Windows'

    - name: Display success message (Windows)
      ansible.builtin.debug:
        msg: >-
          SUCCESS: Connected to {{ inventory_hostname }}.
          OS family={{ ansible_facts['os_family'] }},
          distribution={{ ansible_facts['distribution'] | default('Windows') }},
          version={{ ansible_facts['distribution_version'] | default('N/A') }}.
      when: ansible_facts['os_family'] == 'Windows'
