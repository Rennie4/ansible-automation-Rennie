<!DOCTYPE html>
<html>
<head>
    <style>
        table { font-family: Arial, sans-serif; border-collapse: collapse; width: 100%; }
        td, th { border: 1px solid #dddddd; text-align: left; padding: 8px; }
        .match { color: green; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
<h2>Windows Server 2025 Local Policy Baseline Audit</h2>
<table>
  <tr>
    <th>Policy Setting Name</th>
    <th>Standard Shipped Default</th>
    <th>Audit Status</th>
  </tr>
  {% for result in audit_results.results %}
  <tr>
    <td>{{ result.item.display }}</td>
    <td>{{ result.item.value if result.item.value != '' else 'No One (Empty)' }}</td>
    <td>
      {% if result.failed and 'Failed to translate' in (result.msg | default('')) %}
        <span class="error">✖ TRANSLATION ERROR</span>
      {% elif result.failed %}
        <span class="error">✖ AUDIT FAILURE</span>
      {% else %}
        <span class="match">✔ MATCHES DEFAULT</span>
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>
</body>
</html>
