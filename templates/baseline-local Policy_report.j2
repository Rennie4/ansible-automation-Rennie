<!DOCTYPE html>
<html>
<head>
    <style>
        table { font-family: Arial, sans-serif; border-collapse: collapse; width: 100%; }
        td, th { border: 1px solid #dddddd; text-align: left; padding: 8px; }
        .match { color: green; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>

<h2>Windows Server 2025 Policy Audit Report</h2>
<table>
  <tr>
    <th>Policy Setting Name</th>
    <th>Standard Shipped Default</th>
    <th>Audit Status</th>
  </tr>
  {% for result in policy_results.results %}
  <tr>
    <td>{{ result.item.display }}</td>
    <td>{{ result.item.value }}</td>
    <td>
      {% if result.failed and 'Failed to translate' in result.msg %}
        <span class="error">✖ TRANSLATION ERROR</span>
      {% elif result.changed or result.failed == false %}
        <span class="match">✔ MATCHES DEFAULT</span>
      {% else %}
        <span class="error">✖ MISMATCH / FAILURE</span>
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>

</body>
</html>
