<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Windows Security Baseline Report - {{ inventory_hostname }}</title>
<style>
body { font-family: Arial; background: #f7f7f7; padding: 20px; }
.section { background: white; padding: 15px; margin-bottom: 20px; border-radius: 6px; 
           box-shadow: 0 0 5px rgba(0,0,0,0.2); }
table { width: 100%; border-collapse: collapse; }
td, th { border: 1px solid #ccc; padding: 6px; }
th { background: #efefef; }
</style>
</head>

<body>

<h1>Windows Security Baseline Report</h1>
<p><strong>Hostname:</strong> {{ inventory_hostname }}<br>
<strong>Collected At:</strong> {{ json_report_data.CollectedAtUTC }}</p>

{% set lsp = json_report_data.LocalSecurityPolicy %}

<div class="section">
<h2>Account Policies</h2>
<table>
<tr><th>Setting</th><th>Value</th></tr>
{% for k,v in lsp.SystemAccess.items() %}
<tr><td>{{ k }}</td><td>{{ v }}</td></tr>
{% endfor %}
</table>
</div>

<div class="section">
<h2>Security Options</h2>
<table>
<tr><th>Setting</th><th>Value</th></tr>
{% for k,v in lsp.RegistryValues.items() %}
<tr><td>{{ k }}</td><td>{{ v }}</td></tr>
{% endfor %}
</table>
</div>

<div class="section">
<h2>User Rights Assignment</h2>
<table>
<tr><th>Right</th><th>Assigned To</th></tr>
{% for k,v in lsp.PrivilegeRights.items() %}
<tr><td>{{ k }}</td><td>{{ v }}</td></tr>
{% endfor %}
</table>
</div>

<div class="section">
<h2>Legacy Audit Policy</h2>
<table>
<tr><th>Setting</th><th>Value</th></tr>
{% for k,v in lsp.EventAuditLegacy.items() %}
<tr><td>{{ k }}</td><td>{{ v }}</td></tr>
{% endfor %}
</table>
</div>

<div class="section">
<h2>Advanced Audit Policy</h2>
<table>
<tr><th>Category</th><th>Subcategory</th><th>Setting</th></tr>
{% for row in json_report_data.AdvancedAuditPolicy %}
<tr>
<td>{{ row.Category }}</td>
<td>{{ row.Subcategory }}</td>
<td>{{ row.Setting }}</td>
</tr>
{% endfor %}
</table>
</div>

</body>
</html>
